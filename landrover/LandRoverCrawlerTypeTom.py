SITE_LINKS = {
              "ALABAMA":[
                            "http://www.tomwilliamslandrover.com/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate"
                         ],
              "ARKANSAS":[
                            "http://www.landroverlittlerock.net/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate"
                          ],
              "CALIFORNIA":[
                                "http://www.landroverbritishmotor.com/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                                "http://www.haronmotorsales.com/all-inventory/index.htm?listingConfigId=-all&compositeType=new&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                                "http://www.carlsbadlandrover.com/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                                "http://www.landroveroflivermore.com/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                                "http://www.landroverranchomirage.net/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                                "http://www.landroversandiego.com/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                                "http://www.1000oakslandrover.com/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                                "http://www.landroverventura.net/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate"
                            ],
              "COLORADO":[
                            "http://www.landroverdenvereast.com/all-inventory/index.htm?listingConfigId=-all&compositeType=new&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                            "http://www.landroverhighlandsranch.com/all-inventory/index.htm?listingConfigId=-all&compositeType=new&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                            "http://www.landroverroaringfork.com/all-inventory/index.htm?listingConfigId=-all&compositeType=new&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate"
                          ],
              "CONNECTICUT":[
                                "http://www.landroverdarien.com/all-inventory/index.htm?listingConfigId=-all&compositeType=new&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                                "http://www.landroverfarmingtonvalley.com/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                                "http://www.landroverguilford.net/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                                "http://www.landrovermilford.com/all-inventory/index.htm?listingConfigId=-all&compositeType=new&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate"
                             ],
              "FLORIDA":[
                            "http://www.dimmittlandrover.net/all-inventory/index.htm?listingConfigId=-all&compositeType=new&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                            "http://www.landroverftmyers.net/all-inventory/index.htm?listingConfigId=-all&compositeType=new&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                            "http://www.landroverjacksonville.net/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                            "http://www.landrovernaples.net/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                            "http://www.landroversouthpointe.com/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                            "http://www.landrovertampa.net/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate"
                         ],
              "GEORGIA":[
                            "http://www.landroverbuckhead.net/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate"
                         ],
              "ILLINOIS":[
                            "http://www.landroverhinsdale.net/all-inventory/index.htm?listingConfigId=-all&compositeType=new&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                            "http://www.knauzlandrover.com/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                            "http://www.landroverorlandpark.net/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                            "http://www.landroverpeoria.net/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate"
                          ],
              "INDIANA":[
                            "http://www.landroverindianapolis.com/all-inventory/index.htm?listingConfigId=auto-all&model=Range+Rover&internetPrice=&compositeType=&year=&odometer=&start=0&sort=&facetbrowse=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate"
                         ],
              "KENTUCKY":[
                            "http://www.landroverlouisville.net/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate"
                          ],
              "LOUISIANA":[
                            "http://www.landrovershreveport.com/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate"
                           ],
              "MARYLAND":[
                            "http://www.annapolislandrover.com/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                            "http://www.landroverbethesda.net/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                            "http://www.landroverhuntvalley.com/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                            "http://www.landroverwestcolumbia.com/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate"
                          ],
              "MASSACHUSETTS":[
                                "http://www.landroverofsudbury.com/new-inventory/index.htm?listingConfigId=auto-new&year=&model=SRHS&internetPrice=&start=0&sort=&facetbrowse=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate"
                               ],
              "MICHIGAN":[
                            "http://www.fredlaverylandrover.net/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                            "http://www.landroverfarmingtonhills.com/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                            "http://www.landrovergrandrapids.net/all-inventory/index.htm?search=range+rover",
                            "http://www.landroverlakeside.com/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate"
                          ],
              "NEW JERSEY":[
                                "http://www.landrovercherryhill.com/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                                "http://www.landroveredison.com/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                                "http://www.prestigelandrover.com/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                                "http://www.princetonlandrover.com/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate"
                            ],
              "NEW MEXICO":[
                                "http://www.landroveralbuquerque.com/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate"
                            ],
              "NEW YORK":[
                            "http://www.landroveralbany.com/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                            "http://www.landroveroflarchmont.com/all-inventory/index.htm?listingConfigId=-all&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                            "http://www.landrovermtkisco.com/all-inventory/index.htm?listingConfigId=-all&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate"
                          ],
              "NORTH CAROLINA":[
                                    "http://www.landroverasheville.net/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                                    "http://www.landrovernc.com/all-inventory/index.htm?listingConfigId=auto-new%2Cauto-used&compositeType=&year=&make=Land+Rover&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                                    "http://www.landrovercharlotte.com/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                                    "http://www.landrovercharlotte.com/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate"
                                ],
              "OHIO":[
                        "http://www.cincinnatilandrover.com/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                        "http://www.landroverdublin.com/new-inventory/index.htm?listingConfigId=auto-new&year=&model=Range+Rover&internetPrice=&start=0&sort=&facetbrowse=true&searchLinkText=SEARCH&showRadius=false&showSubmit=true&showSelections=true",
                        "http://www.landroversolon.net/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                        "http://www.landroverwestside.net/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate"
                      ],
              "OKLAHOMA ":[
                            "http://www.bobmoorelandrover.net/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                            "http://www.tulsalandroveronline.com/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate"
                           ],
              "OREGON":[
                        "http://www.landroverportland.com/new-inventory/index.htm?listingConfigId=auto-new&year=&model=Range+Rover&internetPrice=&start=0&sort=&facetbrowse=true&searchLinkText=SEARCH&showRadius=false&showSubmit=true&showSelections=true"
                  ],
              "PENNSYLVANIA ":[
                                "http://www.landroverallentown.com/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                                "http://www.landroverharrisburg.net/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                                "http://www.landrovermainline.com/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate",
                                "http://www.landroverwillowgrove.com/all-inventory/index.htm?listingConfigId=-all&compositeType=&year=&model=Range+Rover&start=0&sort=&facetbrowse=true&quick=true&searchLinkText=SEARCH&showInvTotals=false&showRadius=false&showReset=false&showSubmit=true&facetbrowseGridUnit=BLANK&showSelections=true&dependencies=model%3Amake%2Ccity%3Aprovince%2Ccity%3Astate"
                               ]
              }

ALL_STATES = [
                "ALABAMA","ALASKA","ARIZONA","ARKANSAS","CALIFORNIA","COLORADO","CONNECTICUT","DELEWARE","FLORIDA","GEORGIA","IDAHO","ILLINOIS","INDIANA","IOWA",
                "KANSAS","KENTUCKY","LOUISIANA","MAINE","MARYLAND","MASSACHUSETTS","MICHIGAN","MINNESOTA","MINNEAPOLIS","MISSISSIPPI","MISSOURI","MONTANA","NEBRASKA",
                "NEVADA","NEW HAMPSHIRE","NEW JERSEY","NEW MEXICO","NEW YORK","NORTH DAKOTA","NORTH CAROLINA","OHIO","OKLAHOMA","OREGON","PENNSYLVANIA",
                "RHODE ISLAND","SOUTH CAROLINA","SOUTH DAKOTA","TENNESSEE","TEXAS","UTAH","VIRGINIA","VERMONT","WASHINGTON","WISCONSIN","WEST VIRGINIA"
              ]


from LandRoverParserTypeTom import *

class LandRoverCrawlerTypeTom:
    def __init__(self,browser,uploader):
        self.browser = browser
        self.parser = LandRoverParserTypeTom()
        self.uploader = uploader
        
    def FindDomainName(self,pageLink):
        temp = pageLink.replace('http://','')
        indexOfSlash = temp.find('/')
        domainName = ""
        if indexOfSlash != -1:
            domainName = 'http://'+temp[:indexOfSlash]
        return domainName
    
    def MakeNextLinkUrl(self,url,nextPageNumber):
        indexOfStart = url.find('start=')
        startIndex = indexOfStart
        if indexOfStart != -1:
            startIndex = indexOfStart + len('start=')
            startNumberPortion = ''
            while url[startIndex] >= '0' and url[startIndex] <= '9':
                startNumberPortion += url[startIndex]
                startIndex += 1
            url = url.replace('start='+startNumberPortion,'start='+str(nextPageNumber))
            return url
        else:
            return None
        
    def StartCrawling(self):
        for eachState in ALL_STATES:
            siteLinksForASingleState = SITE_LINKS.get(eachState)
            if siteLinksForASingleState is not None:
                for eachSite in siteLinksForASingleState:
                    currentPageCount,totalPageCount = 0,0
                    page = self.browser.GetPage(eachSite)
                    domainBaseUrl = self.FindDomainName(eachSite)
                    allCarsLinks = []
                    carLinks = self.parser.ParseCarLinks(domainBaseUrl,page)
                    allCarsLinks.extend(carLinks)
                    if len(carLinks) == 16:
                        pageCountTuple = self.parser.ParseTotalPageCount(page)
                        if pageCountTuple is not None and type(pageCountTuple) is tuple:
                            currentPageCount,totalPageCount = pageCountTuple
                            while currentPageCount < totalPageCount:
                                nextPageCount = int(currentPageCount) * 16
                                nextPageUrl = self.MakeNextLinkUrl(eachSite, nextPageCount)
                                page = self.browser.GetPage(nextPageUrl)
                                carLinks = self.parser.ParseCarLinks(domainBaseUrl,page)
                                allCarsLinks.extend(carLinks)
                                if len(carLinks) < 16:
                                    break
                                pageCountTuple = self.parser.ParseTotalPageCount(page)
                                if pageCountTuple is not None and type(pageCountTuple) is tuple:
                                    currentPageCount,totalPageCount = pageCountTuple
                    ###Now we have all the cars links. Need to go through each link.
                    carDetailsList = []
                    for eachCarLink in allCarsLinks:
                        pageSource = self.browser.GetPage(eachCarLink)
                        carDetails = self.parser.ParseCarDetails(eachCarLink,eachState,pageSource)
                        carDetailsList.append(carDetails)
                    print "Uploading Started..."
                    self.uploader.Upload(carDetailsList)                
                    print "Uploading Done!"
                        
            
            
            
            
            
            
            
    